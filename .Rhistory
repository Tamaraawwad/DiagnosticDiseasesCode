"Type 2 diabetes mellitus with diabetic cataract",
"Type 2 diabetes mellitus with diabetic chronic kidney disease",
"Type 2 diabetes mellitus with diabetic dermatitis",
"Type 2 diabetes mellitus with diabetic nephropathy",
"Type 2 diabetes mellitus with diabetic neuropathic arthropathy",
"Type 2 diabetes mellitus with diabetic neuropathy, unspecified"	,
"Type 2 diabetes mellitus with diabetic peripheral angiopathy with gangrene",
"Type 2 diabetes mellitus with diabetic peripheral angiopathy without gangrene",
"Type 2 diabetes mellitus with diabetic polyneuropathy",
"Type 2 diabetes mellitus with foot ulcer",
"Type 2 diabetes mellitus with hyperglycemia",
"Type 2 diabetes mellitus with hyperosmolarity"	,
"Type 2 diabetes mellitus with hyperosmolarity with coma",
"Type 2 diabetes mellitus with hyperosmolarity without nonketotic hyperglycemic-hyperosmolar coma (NKHHC)"	,
"Type 2 diabetes mellitus with hypoglycemia",
"Type 2 diabetes mellitus with hypoglycemia with coma"	,
"Type 2 diabetes mellitus with hypoglycemia without coma"	,
"Type 2 diabetes mellitus with kidney complications"	,
"Type 2 diabetes mellitus with mild nonproliferative diabetic retinopathy"	,
"Type 2 diabetes mellitus with moderate nonproliferative diabetic retinopathy"	,
"Type 2 diabetes mellitus with neurological complications"	,
"Type 2 diabetes mellitus with ophthalmic complications"	,
"Type 2 diabetes mellitus with other circulatory complications"	,
"Type 2 diabetes mellitus with other diabetic arthropathy"	,
"Type 2 diabetes mellitus with other diabetic kidney complication"	,
"Type 2 diabetes mellitus with other diabetic neurological complication"	,
"Type 2 diabetes mellitus with other diabetic ophthalmic complication"	,
"Type 2 diabetes mellitus with other oral complications"	,
"Type 2 diabetes mellitus with other skin complications"	,
"Type 2 diabetes mellitus with other skin ulcer"	,
"Type 2 diabetes mellitus with other specified complication"	,
"Type 2 diabetes mellitus with other specified complications"	,
"Type 2 diabetes mellitus with proliferative diabetic retinopathy"	,
"Type 2 diabetes mellitus with severe nonproliferative diabetic retinopathy without macular edema"	,
"Type 2 diabetes mellitus with skin complications"	,
"Type 2 diabetes mellitus with unspecified complications"	,
"Type 2 diabetes mellitus with unspecified diabetic retinopathy"	,
"Type 2 diabetes mellitus with unspecified diabetic retinopathy with macular edema"	,
"Type 2 diabetes mellitus with unspecified diabetic retinopathy without macular edema"	,
"Type 2 diabetes mellitus without complications"	)
,DM2:=T]
organdm6 <- xtabs(~decripdiag_2016$Organization)
openxlsx :: write.xlsx(organdm6,
file.path(org::PROJ$SHARED_TODAY,"2016organization.xlsx"))
decripdiag_2016[Organization%in% c("Ramallah PHC",
"Nablus PHC",
"Azzoun Clinic",
"Al Karantina Clinic",
"Tarqumia Clinic",
"Qalqilia PHC",
"مركز محمد بن راشد آل مكتوم / مديرية صحة نابلس",
"مركز الأمراض المزمنة و الجلدية")
,ident_clinic:=T]
table6 <- decripdiag_2016[DM2==T & ident_clinic==T,
.(
N=.N
),
keyby=
.(`Patient Sex`,
age_cat,
`Marital Status`
)]
openxlsx :: write.xlsx(table6,
file.path(org::PROJ$SHARED_TODAY,"2016DM2.xlsx"))
#for each clinics the size of patients with dm2 in 2019
table06 <- decripdiag_2016[DM2==T & ident_clinic==T,
.(
N=.N
),
keyby=Organization
]
openxlsx :: write.xlsx(table06,
file.path(org::PROJ$SHARED_TODAY,"2016DM2perorg.xlsx"))
org::AllowFileManipulationFromInitialiseProject()
org::InitialiseProject(
HOME = "C:/Users/enasa/OneDrive/Documents/Diagnostic diseases/DiagnosticDiseasesCode",
DATA_RAW = "C:/Users/enasa/OneDrive/Documents/Diagnostic diseases/data_raw",
SHARED =  "C:/Users/enasa/OneDrive/Documents/Diagnostic diseases/results"
)
library(readxl)
library(openxlsx)
library(data.table)
library(gmodels)
diag_2019 <- read_excel(file.path(org::PROJ$DATA_RAW, "Diag Data" ,"2019.xlsx"))
setDT(diag_2019)
diag_2019[,ident_diag:=TRUE]
diag_2019[,year:=2019]
#some data cleaning &  some decriptive analysis
unique(diag_2018$`Diagnose Name`)
#how to creat age variable from date of birth
#unique(diag_2019$Patient DoB`
#d[, age := as.numeric(difftime(as.Date("2019-01-01"), as.Date(date_of_birth), units="days"))/365.25]
diag_2019[,PatientDoB:=as.Date(`Patient DoB`, format="%d-%m-%Y")]
diag_2019[,admissiondate:=as.Date(`Admission Date`, format="%d-%m-%Y")]
diag_2019[,age:= as.numeric(difftime(as.Date(admissiondate), as.Date(PatientDoB), units="days"))/365.25]
diag_2019[, age:= round(age, digits=0)]
diag_2019[,age_cat:=cut(age,
breaks = c(0,20,30,40,50,60,100)
,include.lowest=T)]
diag_2019[,id_within_baradmission:=1:.N,by=BARADMISSIONID]
xtabs(~diag_2019$id_within_baradmission)
decripdiag_2019 <- diag_2019[id_within_baradmission==1]
nrow(decripdiag_2019)
setDT(decripdiag_2019)
nrow(diag_2019)
diag_2019[Organization%in% c("Ramallah PHC",
"Nablus PHC",
"Azzoun Clinic",
"Al Karantina Clinic",
"Tarqumia Clinic",
"Qalqilia PHC",
"مركز محمد بن راشد آل مكتوم / مديرية صحة نابلس",
"مركز الأمراض المزمنة و الجلدية")
,ident_clinic:=T]
diag_2019 [`Diagnose Name`%in% c("Type 2 diabetes mellitus"	,
"Type 2 diabetes mellitus with circulatory complications",
"Type 2 diabetes mellitus with diabetic arthropathy",
"Type 2 diabetes mellitus with diabetic cataract",
"Type 2 diabetes mellitus with diabetic chronic kidney disease",
"Type 2 diabetes mellitus with diabetic dermatitis",
"Type 2 diabetes mellitus with diabetic nephropathy",
"Type 2 diabetes mellitus with diabetic neuropathic arthropathy",
"Type 2 diabetes mellitus with diabetic neuropathy, unspecified"	,
"Type 2 diabetes mellitus with diabetic peripheral angiopathy with gangrene",
"Type 2 diabetes mellitus with diabetic peripheral angiopathy without gangrene",
"Type 2 diabetes mellitus with diabetic polyneuropathy",
"Type 2 diabetes mellitus with foot ulcer",
"Type 2 diabetes mellitus with hyperglycemia",
"Type 2 diabetes mellitus with hyperosmolarity"	,
"Type 2 diabetes mellitus with hyperosmolarity with coma",
"Type 2 diabetes mellitus with hyperosmolarity without nonketotic hyperglycemic-hyperosmolar coma (NKHHC)"	,
"Type 2 diabetes mellitus with hypoglycemia",
"Type 2 diabetes mellitus with hypoglycemia with coma"	,
"Type 2 diabetes mellitus with hypoglycemia without coma"	,
"Type 2 diabetes mellitus with kidney complications"	,
"Type 2 diabetes mellitus with mild nonproliferative diabetic retinopathy"	,
"Type 2 diabetes mellitus with moderate nonproliferative diabetic retinopathy"	,
"Type 2 diabetes mellitus with neurological complications"	,
"Type 2 diabetes mellitus with ophthalmic complications"	,
"Type 2 diabetes mellitus with other circulatory complications"	,
"Type 2 diabetes mellitus with other diabetic arthropathy"	,
"Type 2 diabetes mellitus with other diabetic kidney complication"	,
"Type 2 diabetes mellitus with other diabetic neurological complication"	,
"Type 2 diabetes mellitus with other diabetic ophthalmic complication"	,
"Type 2 diabetes mellitus with other oral complications"	,
"Type 2 diabetes mellitus with other skin complications"	,
"Type 2 diabetes mellitus with other skin ulcer"	,
"Type 2 diabetes mellitus with other specified complication"	,
"Type 2 diabetes mellitus with other specified complications"	,
"Type 2 diabetes mellitus with proliferative diabetic retinopathy"	,
"Type 2 diabetes mellitus with severe nonproliferative diabetic retinopathy without macular edema"	,
"Type 2 diabetes mellitus with skin complications"	,
"Type 2 diabetes mellitus with unspecified complications"	,
"Type 2 diabetes mellitus with unspecified diabetic retinopathy"	,
"Type 2 diabetes mellitus with unspecified diabetic retinopathy with macular edema"	,
"Type 2 diabetes mellitus with unspecified diabetic retinopathy without macular edema"	,
"Type 2 diabetes mellitus without complications"	)
,DM2:=T]
decripdiag_2019 <- diag_2019[id_within_baradmission==1]
nrow(decripdiag_2019)
setDT(decripdiag_2019)
nrow(diag_2019)
xtabs(~diag_2019$DM2)
xtabs(~decripdiag_2019$id_within_baradmission)
#demographic characters for dm2 in 2019
table2 <- decripdiag_2019[DM2==T & ident_clinic==T,
.(
N=.N
),
keyby=
.(`Patient Sex`,
age_cat,
`Marital Status`
)]
openxlsx :: write.xlsx(table2,
file.path(org::PROJ$SHARED_TODAY,"2019DM2.xlsx"))
#for each clinics the size of patients with dm2 in 2019
tablee <- decripdiag_2019[DM2==T & ident_clinic==T,
.(
N=.N
),
keyby=Organization
]
openxlsx :: write.xlsx(tablee,
file.path(org::PROJ$SHARED_TODAY,"2019DM2perorg.xlsx"))
#data cleaning for 2018
diag_2018 <- read_excel(file.path(org::PROJ$DATA_RAW, "Diag Data" ,"2018.xlsx"))
setDT(diag_2018)
diag_2018[,ident_diag:=TRUE]
diag_2018[,year:=2018]
diag_2018[,PatientDoB:=as.Date(`Patient DoB`, format="%d-%m-%Y")]
diag_2018[,admissiondate:=as.Date(`Admission Date`, format="%d-%m-%Y")]
diag_2018[,age:= as.numeric(difftime(as.Date(admissiondate), as.Date(PatientDoB), units="days"))/365.25]
diag_2018[, age:= round(age, digits=0)]
diag_2018[,age_cat:=cut(age,
breaks = c(0,20,30,40,50,60,100)
,include.lowest=T)]
diag_2018[,id_within_baradmission:=1:.N,by=BARADMISSIONID]
xtabs(~diag_2018$id_within_baradmission)
decripdiag_2018 <- diag_2018[id_within_baradmission==1]
nrow(decripdiag_2018)
setDT(decripdiag_2018)
nrow(diag_2018)
diagnosedm8 <- xtabs(~decripdiag_2018$`Diagnose Name`)
openxlsx :: write.xlsx(diagnosedm8,
file.path(org::PROJ$SHARED_TODAY,"2018diagnosis.xlsx"))
decripdiag_2018 [`Diagnose Name`%in% c("Type 2 diabetes mellitus"	,
"Type 2 diabetes mellitus with circulatory complications",
"Type 2 diabetes mellitus with diabetic arthropathy",
"Type 2 diabetes mellitus with diabetic cataract",
"Type 2 diabetes mellitus with diabetic chronic kidney disease",
"Type 2 diabetes mellitus with diabetic dermatitis",
"Type 2 diabetes mellitus with diabetic nephropathy",
"Type 2 diabetes mellitus with diabetic neuropathic arthropathy",
"Type 2 diabetes mellitus with diabetic neuropathy, unspecified"	,
"Type 2 diabetes mellitus with diabetic peripheral angiopathy with gangrene",
"Type 2 diabetes mellitus with diabetic peripheral angiopathy without gangrene",
"Type 2 diabetes mellitus with diabetic polyneuropathy",
"Type 2 diabetes mellitus with foot ulcer",
"Type 2 diabetes mellitus with hyperglycemia",
"Type 2 diabetes mellitus with hyperosmolarity"	,
"Type 2 diabetes mellitus with hyperosmolarity with coma",
"Type 2 diabetes mellitus with hyperosmolarity without nonketotic hyperglycemic-hyperosmolar coma (NKHHC)"	,
"Type 2 diabetes mellitus with hypoglycemia",
"Type 2 diabetes mellitus with hypoglycemia with coma"	,
"Type 2 diabetes mellitus with hypoglycemia without coma"	,
"Type 2 diabetes mellitus with kidney complications"	,
"Type 2 diabetes mellitus with mild nonproliferative diabetic retinopathy"	,
"Type 2 diabetes mellitus with moderate nonproliferative diabetic retinopathy"	,
"Type 2 diabetes mellitus with neurological complications"	,
"Type 2 diabetes mellitus with ophthalmic complications"	,
"Type 2 diabetes mellitus with other circulatory complications"	,
"Type 2 diabetes mellitus with other diabetic arthropathy"	,
"Type 2 diabetes mellitus with other diabetic kidney complication"	,
"Type 2 diabetes mellitus with other diabetic neurological complication"	,
"Type 2 diabetes mellitus with other diabetic ophthalmic complication"	,
"Type 2 diabetes mellitus with other oral complications"	,
"Type 2 diabetes mellitus with other skin complications"	,
"Type 2 diabetes mellitus with other skin ulcer"	,
"Type 2 diabetes mellitus with other specified complication"	,
"Type 2 diabetes mellitus with other specified complications"	,
"Type 2 diabetes mellitus with proliferative diabetic retinopathy"	,
"Type 2 diabetes mellitus with severe nonproliferative diabetic retinopathy without macular edema"	,
"Type 2 diabetes mellitus with skin complications"	,
"Type 2 diabetes mellitus with unspecified complications"	,
"Type 2 diabetes mellitus with unspecified diabetic retinopathy"	,
"Type 2 diabetes mellitus with unspecified diabetic retinopathy with macular edema"	,
"Type 2 diabetes mellitus with unspecified diabetic retinopathy without macular edema"	,
"Type 2 diabetes mellitus without complications"	)
,DM2:=T]
organ8 <- xtabs(~decripdiag_2018$Organization)
openxlsx :: write.xlsx(organ8,
file.path(org::PROJ$SHARED_TODAY,"2018organization.xlsx"))
decripdiag_2018[Organization%in% c( "Ramallah PHC",
"Nablus PHC",
"Azzoun Clinic",
"Al Karantina Clinic",
"Tarqumia Clinic",
"Qalqilia PHC",
"مركز محمد بن راشد آل مكتوم / مديرية صحة نابلس",
"مركز الأمراض المزمنة و الجلدية")
,ident_clinic:=T]
table2 <- decripdiag_2018[DM2==T & ident_clinic==T,
.(
N=.N
),
keyby=
.(`Patient Sex`,
age_cat,
`Marital Status`
)]
openxlsx :: write.xlsx(table2,
file.path(org::PROJ$SHARED_TODAY,"2018DM2.xlsx"))
table08 <- decripdiag_2018[DM2==T & ident_clinic==T,
.(
N=.N
),
keyby=Organization
]
openxlsx :: write.xlsx(table08,
file.path(org::PROJ$SHARED_TODAY,"2018DM2perorg.xlsx"))
d <- rbind(decripdiag_2019,decripdiag_2018, decripdiag_2017, decripdiag_2016, fill=TRUE)
nrow(d)
# error appeared that the class is different between 2 columns
str(decripdiag_2016)
str(decripdiag_2017)
nrow(decripdiag_2018)
nrow(decripdiag_2016)
d[year=="2018"]
decripdiag_2018[year==2018]
decripdiag_2019[year==2019]
diag_2019[Organization ==" مركز محمد بن راشد آل مكتوم / مديرية صحة نابلس"]
diag_2019[Organization %in% c(" مركز محمد بن راشد آل مكتوم / مديرية صحة نابلس")]
decripdiag_2018[Organization =="Ramallah PHC"]
diag_2018[BARADMISSIONID==2001021085467]
t <- decripdiag_2018[BARADMISSIONID==2001021085467]
openxlsx :: write.xlsx(t,
file.path(org::PROJ$SHARED_TODAY,"77.xlsx"))
#demographic characters for dm2 in 2019 at ramallah
table9R<- d[DM2==T & Organization %in% c("Ramallah PHC"),
.(
N=.N
),
keyby=
.(`Patient Sex`,
age_cat,
`Marital Status`,
year
)]
openxlsx :: write.xlsx(table9R,
file.path(org::PROJ$SHARED_TODAY,"DM2ramallah.xlsx"))
#demographic characters for dm2 in 2019 at nablus
table9n<- d[DM2==T & Organization%in% c("Nablus PHC"),
.(
N=.N
),
keyby=
.(`Patient Sex`,
age_cat,
`Marital Status`,
year
)]
openxlsx :: write.xlsx(table9n,
file.path(org::PROJ$SHARED_TODAY,"DM2nablus.xlsx"))
table9a<- d[DM2==T & Organization%in% c("Azzoun Clinic"),
.(
N=.N
),
keyby=
.(`Patient Sex`,
age_cat,
`Marital Status`,
year
)]
openxlsx :: write.xlsx(table9a,
file.path(org::PROJ$SHARED_TODAY,"DM2azzon.xlsx"))
table9k<- d[DM2==T & Organization%in% c("Al Karantina Clinic"),
.(
N=.N
),
keyby=
.(`Patient Sex`,
age_cat,
`Marital Status`,
year
)]
openxlsx :: write.xlsx(table9k,
file.path(org::PROJ$SHARED_TODAY,"DM2karantina.xlsx"))
table9t<- d[DM2==T & Organization%in% c("Tarqumia Clinic"),
.(
N=.N
),
keyby=
.(`Patient Sex`,
age_cat,
`Marital Status`,
year
)]
openxlsx :: write.xlsx(table9t,
file.path(org::PROJ$SHARED_TODAY,"DM2tarqumia.xlsx"))
table9q<- d[DM2==T & Organization%in% c("Qalqilia PHC"),
.(
N=.N
),
keyby=
.(`Patient Sex`,
age_cat,
`Marital Status`,
year
)]
openxlsx :: write.xlsx(table9q,
file.path(org::PROJ$SHARED_TODAY,"DM2qalqilia.xlsx"))
table9m<- d[DM2==T & Organization %in% c(" مركز محمد بن راشد آل مكتوم / مديرية صحة نابلس"),
.(
N=.N
),
keyby=
.(`Patient Sex`,
age_cat,
`Marital Status`,
year
)]
openxlsx :: write.xlsx(table9m,
file.path(org::PROJ$SHARED_TODAY,"DM2markezmohammad.xlsx"))
table9ma<- d[DM2==T & Organization%in% c("مركز الأمراض المزمنة و الجلدية"),
.(
N=.N
),
keyby=
.(`Patient Sex`,
age_cat,
`Marital Status`,
year
)]
openxlsx :: write.xlsx(table9ma,
file.path(org::PROJ$SHARED_TODAY,"DM2markezamrad.xlsx"))
table9m<- d[DM2==T & Organization %in% c("مركز محمد بن راشد آل مكتوم / مديرية صحة نابلس"),
.(
N=.N
),
keyby=
.(`Patient Sex`,
age_cat,
`Marital Status`,
year
)]
openxlsx :: write.xlsx(table9m,
file.path(org::PROJ$SHARED_TODAY,"DM2markezmohammad.xlsx"))
drugs_2019 <- read_excel(file.path(org::PROJ$DATA_RAW, "Drugs data" ,"2019.xlsx"))
setDT(drug_2019)
drug_2019[,ident_drug:=TRUE]
drug_2019[,id_within_baradmission:=1:.N,by="BARADMISSIONID"]
xtabs(~drug_2019$id_within_baradmission)
reshape(drug_2019,by="CODE")
reshape(drug_2019,by=CODE)
names(drug_2019)
reshape(drug_2019,"CODE")
reshape(drug_2019,"CODE",direction==wide)
reshape(drug_2019,"CODE",direction,c(long,wide))
names(drug_2019)
dcast.data.table(drug_2019,"BARADMISSIONID","CODE", value.var = "code2")
dcast.data.table(drug_2019,"BARADMISSIONID"~"CODE", value.var = "code2")
dcast.data.table(drug_2019,BARADMISSIONID~id_within_baradmission,value.var = "CODE")
widedrugs <- dcast.data.table(drug_2019,BARADMISSIONID~id_within_baradmission,value.var = "CODE")
widedrugs
nrow(widedrugs)
widedrugs[BARADMISSIONID==2001307447169]
drug_2019 <- dcast.data.table(drug_2019,BARADMISSIONID~id_within_baradmission,value.var = "CODE")
drug_2019
nrow(drug_2019)
drug_2019[BARADMISSIONID==2001307447169]
names(drug_2019)
drugs_2019 <- read_excel(file.path(org::PROJ$DATA_RAW, "Drugs data" ,"2019.xlsx"))
setDT(drug_2019)
drug_2019[,ident_drug:=TRUE]
drug_2019[,id_within_baradmission:=1:.N,by="BARADMISSIONID"]
xtabs(~drug_2019$id_within_baradmission)
names(drug_2019)
widedrug_2019 <- dcast.data.table(drug_2019,BARADMISSIONID~id_within_baradmission,value.var = "CODE")
diag_2019 <- read_excel(file.path(org::PROJ$DATA_RAW, "Diag data" ,"2019.xlsx"))
drugs_2019 <- read_excel(file.path(org::PROJ$DATA_RAW, "Drugs data" ,"2019.xlsx"))
setDT(diag_2019)
diag_2019[,ident_diag:=TRUE]
setDT(drug_2019)
drug_2019[,ident_drug:=TRUE]
diag_2019[,id_within_baradmission:=1:.N,by=BARADMISSIONID]
xtabs(~diag_2019$id_within_baradmission)
drug_2019[,id_within_baradmission:=1:.N,by="BARADMISSIONID"]
xtabs(~drug_2019$id_within_baradmission)
names(drug_2019)
#step 1. load in all the data
diag_2019 <- read_excel(file.path(org::PROJ$DATA_RAW, "Diag data" ,"2019.xlsx"))
drugs_2019 <- read_excel(file.path(org::PROJ$DATA_RAW, "Drugs data" ,"2019.xlsx"))
setDT(diag_2019)
diag_2019[,ident_diag:=TRUE]
setDT(drug_2019)
drug_2019[,ident_drug:=TRUE]
diag_2019[,id_within_baradmission:=1:.N,by=BARADMISSIONID]
xtabs(~diag_2019$id_within_baradmission)
drug_2019[,id_within_baradmission:=1:.N,by="BARADMISSIONID"]
xtabs(~drug_2019$id_within_baradmission)
names(drug_2019)
#step 1. load in all the data
diag_2019 <- read_excel(file.path(org::PROJ$DATA_RAW, "Diag data" ,"2019.xlsx"))
drugs_2019 <- read_excel(file.path(org::PROJ$DATA_RAW, "Drugs data" ,"2019.xlsx"))
setDT(diag_2019)
diag_2019[,ident_diag:=TRUE]
setDT(drug_2019)
drug_2019[,ident_drug:=TRUE]
diag_2019[,id_within_baradmission:=1:.N,by=BARADMISSIONID]
xtabs(~diag_2019$id_within_baradmission)
drug_2019[,id_within_baradmission:=1:.N,by="BARADMISSIONID"]
xtabs(~drug_2019$id_within_baradmission)
names(drug_2019)
#step 1. load in all the data
diag_2019 <- read_excel(file.path(org::PROJ$DATA_RAW, "Diag data" ,"2019.xlsx"))
drugs_2019 <- read_excel(file.path(org::PROJ$DATA_RAW, "Drugs data" ,"2019.xlsx"))
setDT(diag_2019)
diag_2019[,ident_diag:=TRUE]
setDT(drug_2019)
drug_2019[,ident_drug:=TRUE]
diag_2019[,id_within_baradmission:=1:.N,by=BARADMISSIONID]
xtabs(~diag_2019$id_within_baradmission)
drug_2019[,id_within_baradmission:=1:.N,by="BARADMISSIONID"]
xtabs(~drug_2019$id_within_baradmission)
names(drug_2019)
drugs_2019 <- read_excel(file.path(org::PROJ$DATA_RAW, "Drugs data" ,"2019.xlsx"))
org::AllowFileManipulationFromInitialiseProject()
org::InitialiseProject(
HOME = "C:/Users/enasa/OneDrive/Documents/Diagnostic diseases/DiagnosticDiseasesCode",
DATA_RAW = "C:/Users/enasa/OneDrive/Documents/Diagnostic diseases/data_raw",
SHARED =  "C:/Users/enasa/OneDrive/Documents/Diagnostic diseases/results"
)
library(readxl)
library(openxlsx)
library(data.table)
library(gmodels)
#step 1. load in all the data
diag_2019 <- read_excel(file.path(org::PROJ$DATA_RAW, "Diag data" ,"2019.xlsx"))
drugs_2019 <- read_excel(file.path(org::PROJ$DATA_RAW, "Drugs data" ,"2019.xlsx"))
setDT(diag_2019)
diag_2019[,ident_diag:=TRUE]
setDT(drug_2019)
drug_2019[,ident_drug:=TRUE]
diag_2019[,id_within_baradmission:=1:.N,by=BARADMISSIONID]
xtabs(~diag_2019$id_within_baradmission)
drug_2019[,id_within_baradmission:=1:.N,by="BARADMISSIONID"]
xtabs(~drug_2019$id_within_baradmission)
names(drug_2019)
names(drug_2019)
nrow(drug_2019)
drug_2019[BARADMISSIONID==2001307447169]
